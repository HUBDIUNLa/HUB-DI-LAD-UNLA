
document.addEventListener('DOMContentLoaded', () => {
  const btnResumen = document.getElementById('btnResumen');
  const btnPresupuesto = document.getElementById('btnPresupuesto');

  if (btnResumen) {
    btnResumen.addEventListener('click', () => {
      const nombre = document.getElementById("nombreSolicitante").value.trim();
      const dni = document.getElementById("dniSolicitante").value.trim();
      const cuil = document.getElementById("cuilSolicitante").value.trim();
      const direccion = document.getElementById("direccionSolicitante").value.trim();
      const fecha = document.getElementById('fecha').value;
      const plazo = document.getElementById('plazoValidez').value;
      const formasPago = Array.from(document.querySelectorAll('input[name="pago"]:checked')).map(cb => cb.value);
      const conformidad = document.querySelector('input[name="conformidad"]:checked')?.value || "No especificado";

      const datosHTML = `
        <li><strong>Apellido y Nombre:</strong> ${nombre}</li>
        <li><strong>DNI:</strong> ${dni}</li>
        <li><strong>CUIL:</strong> ${cuil}</li>
        <li><strong>Dirección:</strong> ${direccion}</li>
        <li><strong>Fecha:</strong> ${fecha}</li>
        <li><strong>Plazo de validez:</strong> ${plazo}</li>
        <li><strong>Forma de pago:</strong> ${formasPago.join(', ') || 'No especificada'}</li>
        <li><strong>¿Presto conformidad?:</strong> ${conformidad}</li>
      `;
      document.getElementById('datosPersona').innerHTML = datosHTML;
      document.getElementById('resumenSolicitante').classList.remove('hidden');
    });
  }

  if (btnPresupuesto) {
    btnPresupuesto.addEventListener('click', async () => {
      const emailInput = document.getElementById('emailSolicitante');
      const emailSolicitante = emailInput.value.trim();

      if (!emailSolicitante || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailSolicitante)) {
        alert("Por favor, ingresá un correo electrónico válido.");
        emailInput.classList.add("border-red-500");
        return;
      } else {
        emailInput.classList.remove("border-red-500");
      }

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      // Imágenes en base64
      const hubImg = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAAA9CAYAAACzSAj3AAABY0lEQVR4nO3YsQ3CMBAF0SJSnMgA3NBSZB3ACux8m5TRDEME+VuX0Wy2ydXn+df5fAxERERERERERERERERER8XtGuVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3iVEeVsxE8E3j+UreERERERERERERERERETkV/wAHqxGpZ3cqRAAAAAElFTkSuQmCC";
      const unlaImg = "data:image/jpeg;base64,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"; 
      const ladImg = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAA9klEQVR4nO3SsQ0AIBAEwT4Kk0TAHuWrjGCCFYeyNLsYp7j+Px8fHx8fHx8fHw9/n8vP29fHw9fX2+/Xz8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fH//2Q==";
      const firmaImg = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUgAAABDCAYAAABcPMrJAAABtElEQVR4nO3XQQ6DIBQFUJjwO/dD8w+TMI+0dCUY+eWxd8glubdNxZJhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwF/t48LG2UkmS5Ha3xn1f0tJ++5KRi+ZPjtnc9Xxd/m0qlWq1Wq1Wq1Wq9XyMZySJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS3U3fRABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8XfgCOvPAc9vx4nAAAAAElFTkSuQmCC";

      // Agregar logos
      doc.addImage(unlaImg, "JPEG", 10, 10, 25, 25);
      doc.addImage(hubImg, "PNG", 40, 10, 25, 25);
      doc.addImage(ladImg, "PNG", 70, 10, 25, 25);

      const nombre = document.getElementById("nombreSolicitante").value.trim();
      const dni = document.getElementById("dniSolicitante").value.trim();
      const cuil = document.getElementById("cuilSolicitante").value.trim();
      const direccion = document.getElementById("direccionSolicitante").value.trim();
      const fecha = document.getElementById('fecha').value;
      const plazo = document.getElementById('plazoValidez').value;
      const formasPago = Array.from(document.querySelectorAll('input[name="pago"]:checked')).map(cb => cb.value).join(', ');
      const conformidad = document.querySelector('input[name="conformidad"]:checked')?.value || "No especificado";

      doc.setFontSize(16);
      doc.text("Presupuesto HUB DI UNLa", 10, 45);

      doc.setFontSize(12);
      let y = 55;
      const datos = [
        `Nombre: ${nombre}`,
        `DNI: ${dni}`,
        `CUIL: ${cuil}`,
        `Dirección: ${direccion}`,
        `Fecha: ${fecha}`,
        `Plazo de validez: ${plazo}`,
        `Forma de pago: ${formasPago}`,
        `¿Presto conformidad?: ${conformidad}`,
        `Email: ${emailSolicitante}`,
      ];
      datos.forEach(d => {
        doc.text(d, 10, y);
        y += 7;
      });

      const rows = [];
      document.querySelectorAll('.item').forEach(fila => {
        const proceso = fila.querySelector('.proceso').value;
        const material = fila.querySelector('.material').value;
        const tamanio = fila.querySelector('.tamanio').value;
        const complejidad = fila.querySelector('.complejidad').value;
        const plano = fila.querySelector('.plano').checked ? "Sí" : "No";
        const materialPropio = fila.querySelector('.material-propio').checked ? "Sí" : "No";
        const subtotal = fila.querySelector('.subtotal').textContent;
        rows.push([proceso, material, tamanio, complejidad, plano, materialPropio, subtotal]);
      });

      doc.text("Detalle de servicios:", 10, y + 5);
      y += 10;
      const startX = 10;
      const colWidths = [30, 30, 20, 25, 25, 25, 25];
      const headers = ["Proceso", "Material", "Tamaño", "Complejidad", "Plano", "Material", "Subtotal"];
      headers.forEach((h, i) => {
        doc.text(h, startX + colWidths.slice(0, i).reduce((a, b) => a + b, 0), y);
      });
      y += 6;
      rows.forEach(row => {
        row.forEach((text, i) => {
          doc.text(String(text), startX + colWidths.slice(0, i).reduce((a, b) => a + b, 0), y);
        });
        y += 6;
      });

      y += 4;
      const total = document.getElementById("totalFinal").textContent;
      doc.setFontSize(13);
      doc.text(`Total: ${total}`, 10, y);

      // Firma del HUB al final del documento
      doc.addImage(firmaImg, "PNG", 140, 250, 50, 20);

      const pdfBlob = doc.output("blob");
      const formData = new FormData();
      formData.append("pdf", pdfBlob, "presupuesto.pdf");
      formData.append("email", emailSolicitante);

      console.log("Enviando a backend:", emailSolicitante, formData);

      try {
        const response = await fetch("https://backend-hubdi.onrender.com/enviar-presupuesto", {
          method: "POST",
          body: formData,
        });

        if (response.ok) {
          alert("El presupuesto ha sido enviado por correo electrónico.");
        } else {
          alert("Error al enviar el presupuesto.");
        }
      } catch (error) {
        console.error("Error al enviar el presupuesto:", error);
        alert("Error al enviar el presupuesto.");
      }
    });
  }
});

window.addEventListener("DOMContentLoaded", agregarFila);
